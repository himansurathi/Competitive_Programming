Drupal.fbconnect=Drupal.fbconnect||{};Drupal.fbconnect.init=function(){Drupal.behaviors.fbconnect=function(t){if(t!=document){jQuery(t).each(function(){FB.XFBML.parse(this)})}Drupal.fbconnect.initLogoutLinks(t)};if(Drupal.settings.fbconnect.loginout_mode=="auto"){FB.Event.subscribe("auth.authResponseChange",Drupal.fbconnect.reload_ifUserConnected)}Drupal.behaviors.fbconnect(document)};Drupal.fbconnect.logout=function(t){var o=Drupal.settings.basePath+"logout";if(!t){FB.logout(function(t){window.location.href=o})}else{window.location.href=o}};Drupal.fbconnect.reload_ifUserConnected=function(t){var o=Drupal.settings.fbconnect.user;if(!t.authResponse||o.uid)return;if(t.authResponse.uid!=o.fbuid){window.location.reload()}};Drupal.fbconnect.initLogoutLinks=function(t){var o=Drupal.settings.fbconnect.loginout_mode;var e=Drupal.settings.fbconnect.user;var n=Drupal.settings.basePath;var i=n+"logout";var a=$("a[href="+i+"]",t).not(".logout_link_inited");if(o=="manual")return;a.addClass("logout_link_inited").bind("click",function(){var t=FB.getAuthResponse()&&FB.getAuthResponse().uid;if(!e.fbuid||e.fbuid!=t)return;if(o=="auto"){Drupal.fbconnect.logout()}else if(o=="ask"){var n={"!site_name":Drupal.settings.fbconnect.invite_name};var i=[{label:Drupal.t("Facebook and !site_name",n),click:function(){this.close();Drupal.fbconnect.logout()}},{name:"cancel",label:Drupal.t("!site_name Only",n),click:function(){this.close();Drupal.fbconnect.logout(true)}}];var a=new Drupal.fbconnect.PopupDialog({title:Drupal.t("Logout"),message:Drupal.t("Do you also want to logout from your Facebook account?"),buttons:i})}return false})};Drupal.fbconnect.DoFastRegistration=function(t){FB.login(function(o){if(o.authResponse&&o.status=="connected"){FB.api("/me/permissions",function(o){if(o["data"][0]["email"]){window.location.href=t.href}})}},{scope:"email"})};function facebook_onlogin_ready(){if(!FB.getAuthResponse()){return}$("#fbconnect-autoconnect-form").submit()}Drupal.fbconnect.PopupDialog=function(t){this.prepareDefaults(t);this.container=Drupal.theme("fb_popup_dialog",this.options);this.dialog=FB.Dialog.create({content:this.container,visible:false,loader:true,onClose:this.__close_handler,closeIcon:true});this.callback("load",this.dialog)};Drupal.fbconnect.PopupDialog.prototype.options={};Drupal.fbconnect.PopupDialog.prototype.createHandler=function(t,o){var e=this;return function(){e.callback(t,o)}};Drupal.fbconnect.PopupDialog.prototype.callback=function(t,o){o=o||{};switch(t){case"click":var e=o;if(e.click instanceof Function)e.click.apply(this,[e]);else if(e.name=="cancel")this.close();break;case"close":var e=this.findButton("cancel");if(e)this.callback("click",e);break;case"load":this.show();break}};Drupal.fbconnect.PopupDialog.prototype.prepareDefaults=function(t){var o={title:"",message:" - ",buttons:{},showLoading:false,hideUntilLoaded:false};$.extend(this.options,o,t);this.__close_handler=this.createHandler("close",{});this.options.dialog=this;if(this.options.callback instanceof Function){this.callback=this.options.callback}};Drupal.fbconnect.PopupDialog.prototype.show=function(){if(this.dialog){FB.Dialog.show(this.dialog)}};Drupal.fbconnect.PopupDialog.prototype.close=function(){if(this.dialog){FB.Dialog.remove(this.dialog)}};Drupal.fbconnect.PopupDialog.prototype.findButton=function(t){var o=null;jQuery.each(this.options.buttons,function(e,n){if(n.name==t){o=n;return true}});return o};Drupal.theme.prototype.fb_popup_dialog_buttons=function(t,o){t=t||{};var e=$('<div class="dialog_buttons"></div>');jQuery.each(t,function(t,n){var i=$('<input type="button" class="dialog_inputbutton">');if(!n["name"])n["name"]=t;if(n.attr)i.attr(n.attr);if(n["class"])i.addClass(n["class"]);if(n["name"]=="cancel")i.addClass("dialog_inputaux");i.addClass("fb_button_"+t);i.attr("value",n.label);i.click(o.createHandler("click",n));i.appendTo(e)});return e.get(0)};Drupal.theme.prototype.fb_popup_dialog=function(t){t=t||{buttons:{}};var o=document.createDocumentFragment();var e=['<h2 class="dialog_header"><span>',t.title.toString(),"</span></h2>",'<div class="dialog_stripes"></div>','<div class="dialog_content">',t.message.toString(),"</div>"];$(e.join("\n")).each(function(){o.appendChild(this)});if(t.buttons){o.appendChild(Drupal.theme("fb_popup_dialog_buttons",t.buttons,t.dialog))}return o};Drupal.theme.prototype.fbml_name=function(t,o){var e=['<fb:name uid="',t,'"'];var n={useyou:false,linked:false};o=$.extend({},n,o);e.push('" useyou="'+(!!o.useyou?"true":"false")+'"');e.push('" linked="'+(!!o.linked?"true":"false")+'"');e.push("></fb:name>");return e.join("")};Drupal.theme.prototype.fbml_profile_pic=function(t,o){var e=['<fb:profile-pic uid="',t,'"'];o=o||{};if(o.width)e.push('" width="'+o.width+'"');if(o.height)e.push('" height="'+o.height+'"');if(o.size)e.push('" size="'+o.size+'"');e.push('" facebook-logo="'+(!!o["facebook-logo"]?"true":"false")+'"');e.push('" linked="'+(!!o.linked?"true":"false")+'"');e.push("></fb:profile-pic>");return e.join("")};jQuery(document).bind("fb:init",Drupal.fbconnect.init);function fb_invite_nonchallenge(t,o){$("#//For removal a").click(function(){window.open("/fbinvite/friends?d="+o+"&p="+t+"&c=0","facebook_window","scrollbars=1,width=800px,height=650px")});$("#FB_disp_message p").html("Ask your friends to help you solve this problem by using: ");return false}function fb_invite_challenge(t,o){$("#facebook-button a").click(function(){window.open("/fbinvite/friends?d="+o+"&p="+t+"&c=1","facebook_window","scrollbars=1,width=800px,height=650px")});$("#FB_disp_message p").html("Challenge your friends using: ");return false}